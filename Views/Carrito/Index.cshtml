@model TiendaPc.Controllers.CarritoVm
@{
  ViewData["Title"] = "Tu Carrito";
  Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1 class="text-2xl font-semibold mb-4">Tu Carrito</h1>

@if (Model.Items.Count == 0)
{
  <div class="bg-white rounded-xl shadow p-6 text-center">
    <p class="text-gray-600">Tu carrito está vacío.</p>
    <a href="/Catalogo/Index" class="mt-3 inline-block px-4 py-2 rounded bg-black text-white">Ir al catálogo</a>
  </div>
}
else
{
  <div class="overflow-x-auto bg-white rounded-xl shadow">
    <table class="w-full">
      <thead class="text-left">
        <tr class="border-b">
          <th class="p-3">Producto</th>
          <th class="p-3">SKU</th>
          <th class="p-3">Cantidad</th>
          <th class="p-3">Precio</th>
          <th class="p-3">Total</th>
          <th class="p-3"></th>
        </tr>
      </thead>
      <tbody>
      @foreach (var x in Model.Items)
      {
        <tr class="border-t">
          <td class="p-3">@x.Nombre</td>
          <td class="p-3">@x.Sku</td>
          <td class="p-3">
            <form method="post" action="/Carrito/ActualizarCantidad" class="flex items-center gap-2">
              <input type="hidden" name="idItem" value="@x.IdItem" />
              <input type="number" min="0" name="cantidad" value="@x.Cantidad" class="w-20 border rounded px-2 py-1" />
              <button class="px-3 py-1 rounded bg-gray-900 text-white text-sm">Actualizar</button>
            </form>
          </td>
          <td class="p-3">S/ @x.PrecioUnitario.ToString("0.00")</td>
          <td class="p-3">S/ @x.Total.ToString("0.00")</td>
          <td class="p-3">
            <form method="post" action="/Carrito/Quitar">
              <input type="hidden" name="idItem" value="@x.IdItem" />
              <button class="px-3 py-1 rounded bg-red-600 text-white text-sm">Quitar</button>
            </form>
          </td>
        </tr>
      }
      </tbody>
    </table>
  </div>

  <div class="mt-4 flex flex-col md:flex-row gap-4 md:items-start md:justify-between">
    <form method="post" action="/Carrito/Vaciar">
      <button class="px-4 py-2 rounded border">Vaciar carrito</button>
    </form>

    <div class="bg-white rounded-xl shadow p-4 w-full md:w-80">
      <div class="flex justify-between"><span>Subtotal</span><b>S/ @Model.Subtotal.ToString("0.00")</b></div>
      <div class="flex justify-between"><span>IGV (18%)</span><b>S/ @Model.Igv.ToString("0.00")</b></div>
      <div class="flex justify-between text-lg mt-2"><span>Total</span><b>S/ @Model.Total.ToString("0.00")</b></div>
      <a href="/Checkout" class="mt-3 inline-block w-full text-center px-4 py-2 rounded bg-black text-white">Ir a pagar</a>


    </div>
  </div>
}
